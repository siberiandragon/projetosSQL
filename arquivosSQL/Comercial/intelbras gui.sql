select distinct
       N.CODFILIAL as FILIAL,
       M.DTMOV as Data_fat,
       I.NOME as RCA, 
       M.NUMNOTA as NFe,
       R.CGCENT as CNPJ,
       R.CLIENTE as Razao_Social,
       D.DESCRICAO as Unidade, 
       S.DESCRICAO as Segmento,
       M.CODINTERNO as Cod_Fab, 
       P.DESCRICAO as Descricao,
       M.MARCA,
       M.QT as Qtde,
       M.PUNIT as Vl_Unit,
       (M.PUNIT * M.QT) as TOTAL,
       M.PERCDESC as Desconto,
       (T.QTESTGER - T.QTRESERV - T.QTBLOQUEADA) as EstDisp,
       nvl(T.QTVENDMES1, 0) as Vendas_mes_1,   
       nvl(T.QTVENDMES2, 0) as Vendas_mes_2,   
       nvl(T.QTVENDMES3, 0) as Vendas_mes_3,
       C.DESCRICAO as Cobranca,
       E.OBSENTREGA1,
       decode(E.CONDVENDA,1, 'VENDA NORMAL',5, 'BONIFICAÇÂO',7, 'NOTA MÃE',8, 'NOTA FILHA',9, 'DEMOSNTRAÇÃO',10, 'TRANSFERÊNCIA') as TIPO_VENDA
 
from PCMOV M
join PCNFSAID N on M.NUMNOTA = N.NUMNOTA
join PCCLIENT R on M.CODCLI = R.CODCLI
join PCDEPTO  D on M.CODEPTO = D.CODEPTO
join PCSECAO  S on M.CODSEC = S.CODSEC
join PCPRODUT P on M.CODPROD = P.CODPROD
join PCPLPAG  C on N.CODPLPAG = C.CODPLPAG
join PCPEDC   E on N.NUMNOTA = E.NUMNOTA
join PCMARCA  M on P.CODMARCA = M.CODMARCA
join PCUSUARI I on M.CODUSUR = I.CODUSUR
join PCEST    T on P.CODPROD = T.CODPROD and N.CODFILIAL = T.CODFILIAL
where 
M.CODMARCA = '2'
and R.CGCENT in 
('99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999',
'99999999999999')      
and M.DTMOV between '01/05/2023' and '28/08/2023'
and M.CODFILIAL in ('3')
and M.CODCLI in ('3187')
and I.CODUSUR in ('1077')
and I.CODSUPERVISOR in ('3')  
and M.PUNIT > 0 and M.QT > 0
and E.CONDVENDA in ('1','7')
and M.NUMNOTA = ('33332233')
order by M.CODINTERNO;









