select distinct
PCPEDC.CODFILIAL as FILIAL,
 PCPEDC.DATA,
  decode(PCPEDC.CODFUNCEMISSAOMAPA,7,'PADRÃO',11,'ALLAN DIEGO',28,'GUILHERME CAVALCANTI',30,'ADRIANO ASSIS',51,'LAIZ CLEMENTINO',52,'WILLIANS CLEITON',53,'ALEX SANDRO',54,'ANDRE ROBSON',77,'PATRICIA SOUZA',78,'DIEGO MOURA',79,'RAFAEL MARTINS',80,'PAULO JOSÉ',94,'LEONARDO DE SOUZA',95,'ANDERSON LOBATO',101,'JOSÉ JUNIOR',109,'JOSÉ HEWERTON') as EMITENTE_MAPA,
   decode(PCPEDC.CODFUNCSEP,7,'PADRÃO',11,'ALLAN DIEGO',28,'GUILHERME CAVALCANTI',30,'ADRIANO ASSIS',51,'LAIZ CLEMENTINO',52,'WILLIANS CLEITON',53,'ALEX SANDRO',54,'ANDRE ROBSON',77,'PATRICIA SOUZA',78,'DIEGO MOURA',79,'RAFAEL MARTINS',80,'PAULO JOSÉ',94,'LEONARDO DE SOUZA',95,'ANDERSON LOBATO',101,'JOSÉ JUNIOR',109,'JOSÉ HEWERTON') as SEPARADOR, 
    decode(PCPEDC.CODFUNCCONF,7,'PADRÃO',11,'ALLAN DIEGO',28,'GUILHERME CAVALCANTI',30,'ADRIANO ASSIS',51,'LAIZ CLEMENTINO',52,'WILLIANS CLEITON',53,'ALEX SANDRO',54,'ANDRE ROBSON',77,'PATRICIA SOUZA',78,'DIEGO MOURA',79,'RAFAEL MARTINS',80,'PAULO JOSÉ',94,'LEONARDO DE SOUZA',95,'ANDERSON LOBATO',101,'JOSÉ JUNIOR',109,'JOSÉ HEWERTON') as CONFERENTE,
    decode(PCPEDC.ORIGEMPED,'R','RETIRA','T','ENTREGA')as TIPO_VENDA,
     PCPEDC.NUMPED as PEDIDO,
      PCPEDC.TOTPESO as PESO_TOTAL,
       PCPEDC.NUMITENS as QTD_SKU,
        (select SUM (PCPEDI.QT / PCEMBALAGEM.QTUNIT) 
         from PCPEDI
         join PCEMBALAGEM on PCPEDI.CODPROD = PCEMBALAGEM.CODPROD and PCEMBALAGEM.CODFILIAL = PCPEDC.CODFILIAL
         where PCPEDI.NUMPED = PCPEDC.NUMPED)  as QTD_ITENS,
         case 
           when PCPEDC.DTLIBERA is null 
           then PCPEDC.DTFIMDIGITACAOPEDIDO
           else PCPEDC.DTLIBERA 
           end as DTLIBERAÇÃO,
          PCPEDC.DTEMISSAOMAPA as DTEMISSÃO_MAPA,
           PCPEDC.DTINICIALSEP,
            PCPEDC.DTFINALCHECKOUT as DTCONFERÊNCIA,
            EXTRACT(HOUR FROM (NUMTODSINTERVAL(DTFINALCHECKOUT - DTEMISSAOMAPA, 'DAY'))) || ':' ||
             EXTRACT(MINUTE FROM (NUMTODSINTERVAL(DTFINALCHECKOUT - DTEMISSAOMAPA, 'DAY'))) || ':' ||
              EXTRACT(SECOND FROM (NUMTODSINTERVAL(DTFINALCHECKOUT - DTEMISSAOMAPA, 'DAY'))) AS TEMPO_MEDIO 
from PCPEDC
join PCEMPR on PCPEDC.CODFUNCSEP = PCEMPR.MATRICULA
join PCUSUARI on PCPEDC.CODUSUR = PCUSUARI.CODUSUR
--join PCPEDI on PCPEDC.NUMPED = PCPEDI.NUMPED
--join PCEMBALAGEM on PCPEDI.CODPROD = PCEMBALAGEM.CODPROD and PCEMBALAGEM.CODFILIAL = PCPEDC.CODFILIAL 
--join PCPEDC on PCEMBALAGEM.CODFILIAL = PCPEDC.CODFILIAL
--join PCPEDI on PCPEDC.NUMPED = PCPEDI.NUMPED
--join PCEMBALAGEM on PCPEDI.CODPROD = PCEMBALAGEM.CODPROD and PCPEDI.CODFILIALRETIRA = PCEMBALAGEM.CODFILIAL
where
--PCPEDC.CODFILIAL IN(:CODIGO) 
--and PCEMPR.MATRICULA IN(:MATRICULA)
--and PCUSUARI.CODUSUR IN(:CODUSUR) 
--and 
PCPEDC.NUMPED ='1011000096'; 
--and PCPEDC.DATA between :DATINI and :DATFIM
--and rownum <=1;



select CODFUNCEMISSAOMAPA as MAPA_EMISSOR, CODFUNCSEP as SEPARADOR, CODFUNCCONF as CONFERENTE from PCPEDC
where NUMPED='1011000096';