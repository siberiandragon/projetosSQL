select * from PCPEDI 
where NUMPED='1003000314';

select PCPEDI.NUMPED, PCPEDI.CODPROD, PCPRODUT.DESCRICAO, PCPEDI.QT, PCEST.QTEST, PCPEDI.POSICAO from PCPEDI
join PCEST on PCPEDI.CODPROD = PCEST.CODPROD and PCPEDI.CODFILIALRETIRA = PCEST.CODFILIAL
join PCPRODUT on PCPEDI.CODPROD = PCPRODUT.CODPROD 
where  PCPEDI.CODFILIALRETIRA='2' and PCPEDI.POSICAO='P' and PCPEDI.QT > PCEST.QTEST
order by PCPEDI.NUMPED;

select * from PCEST
where CODPROD=5302;

select * from PCPRODUT
where CODPROD=5302;

select PCPEDI.CODPROD from PCPEDI
join PCEST on PCPEDI.CODPROD = PCEST.CODPROD and PCPEDI.CODFILIALRETIRA = PCEST.CODFILIAL
join PCPRODUT on PCPEDI.CODPROD = PCPRODUT.CODPROD 
join PCPEDC on PCPEDC.NUMPED = PCPEDI.NUMPED
where PCPEDI.CODFILIALRETIRA='2' and PCPEDI.CODPROD=''5639 and PCPEDI.POSICAO='P' and PCPEDC.NUMPED='1011000217';

select PCPEDI.CODFILIALRETIRA, PCPEDI.NUMPED, PCPEDI.CODPROD, PCPEDI.DATA, PCPRODUT.DESCRICAO, PCPEDI.QT, 
coalesce(PCEST.QTEST, 0) as QTEST,PCPEDI.QT - PCEST.QTEST as PENDENTE, PCPEDI.POSICAO 
from PCPEDI
join PCEST on PCPEDI.CODPROD = PCEST.CODPROD and PCPEDI.CODFILIALRETIRA = PCEST.CODFILIAL
join PCPRODUT on PCPEDI.CODPROD = PCPRODUT.CODPROD 
where PCPEDI.CODFILIALRETIRA in('2','3','4') and PCPEDI.POSICAO = 'P'  
and PCPEDI.QT > coalesce(PCEST.QTEST, 0) 
order by PCPEDI.QT;

