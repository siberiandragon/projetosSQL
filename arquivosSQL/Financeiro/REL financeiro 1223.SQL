

select  PCEMPR.NOME,
        PCSTATUSCOBCLI.STATUSCOB
         ,PCHISTCOB.OBS2
          ,PCHISTCOB.OBS1
from PCHISTCOB
join PCEMPR on PCHISTCOB.CODFUNC = PCEMPR.MATRICULA
join PCSTATUSCOBCLI on PCHISTCOB.CODSTATUSCOB = PCSTATUSCOBCLI.CODSTATUSCOB
join PCHISTCOBI on PCHISTCOB.NUMREGCOB = PCHISTCOBI.NUMREGCOB
join PCPREST on PCPREST.NUMTRANSVENDA = PCHISTCOBI.NUMTRANSVENDA 
where PCPREST.NUMTRANSVENDA='161316'
and rownum <=1;

--TROCANDO A TABELA EM FROM PELO PCHISTCOB( A QUAL POSSUIA TODAS AS INFORMAÇÕES DA CONSULTA) 
select PCEMPR.NOME, PCSTATUSCOBCLI.STATUSCOB, PCHISTCOB.OBS2, PCHISTCOB.OBS3
from PCHISTCOB
join PCHISTCOBI on PCHISTCOB.NUMREGCOB = PCHISTCOBI.NUMREGCOB
join PCPREST on PCHISTCOBI.NUMTRANSVENDA = PCPREST.NUMTRANSVENDA
join PCEMPR on PCPREST.CODFUNCULTALTER = PCEMPR.MATRICULA
join PCSTATUSCOBCLI on PCPREST.CODSTATUSCOB = PCSTATUSCOBCLI.CODSTATUSCOB
where PCPREST.CODCLI = '4274'
and PCPREST.DTVENC <= SYSDATE
and PCPREST.DTPAG is null;


SELECT OBS,OBS1,OBS2 FROM PCPEDC
WHERE NUMPED='1114000154';

SELECT * FROM PCHISTCOB
WHERE NUMREGCOB='602';

SELECT * FROM PCHISTCOBI
WHERE NUMREGCOB='602';

SELECT * FROM PCSTATUSCOBCLI;

------------------------------------------------

select * from  PCPREST 
where CODCLI='21789';


select  CODCLI, PREST, DUPLIC,  DTVENC, DTPAG, DTULTALTER, NUMTRANSVENDA, VALORORIG, VPAGO from PCPREST
where PCPREST.CODCLI='450'
and PCPREST.DTVENC <= SYSDATE
and PCPREST.DTPAG is null
order by PCPREST.DTVENC;
-----------------

--MARK 1
select distinct
    PCPREST.CODFILIAL,
     PCCLIENT.CLIENTE,
      PCCLIENT.FANTASIA,
       PCPREST.CODUSUR, 
        PCUSUARI.NOME,
         PCPREST.VALOR,
          PCPREST.VLRTOTDESPESASEJUROS,
           PCPREST.CODCLI,
            PCPREST.DTEMISSAO,
             PCPREST.DUPLIC,
              PCPREST.PREST,
               PCHISTCOB.DATA as DTCOB,
                PCPREST.DTVENC,
                 PCPREST.DTVENCORIG,
                  PCPREST.DTPAG,           
                   case when PCPREST.DTVENC >= SYSDATE then 0
                    else round(SYSDATE - PCPREST.DTVENC,0) END as ATRASO2,
                     PCCOB.COBRANCA,
                      PCEMPR.NOME,  
                       PCHISTCOBI.ATRASO,
                        PCSTATUSCOBCLI.STATUSCOB,
                         PCHISTCOB.OBS2,
                          PCHISTCOB.OBS3

from 
    (PCPREST 
    LEFT join PCHISTCOBI on PCHISTCOBI.NUMTRANSVENDA = PCPREST.NUMTRANSVENDA and PCPREST.PREST = PCHISTCOBI.PREST)
    LEFT join PCHISTCOB on PCHISTCOB.NUMREGCOB = PCHISTCOBI.NUMREGCOB
    LEFT join PCEMPR on PCHISTCOB.CODFUNC = PCEMPR.MATRICULA 
    LEFT join PCSTATUSCOBCLI on PCPREST.CODSTATUSCOB = PCSTATUSCOBCLI.CODSTATUSCOB 
    join PCCOB on PCPREST.CODCOB = PCCOB.CODCOB
    join PCCLIENT on PCPREST.CODCLI = PCCLIENT.CODCLI
    join PCUSUARI on PCPREST.CODUSUR = PCUSUARI.CODUSUR
    where 
        PCPREST.DTVENC 
        between
        '01/06/2023'
        and
        '19/06/2023'
        and PCPREST.DTPAG is null
        and PCPREST.CODCLI in ('4274')
        and PCPREST.CODCOB not in ('DESD')
        
order by PCPREST.CODCLI, 
          PCPREST.DTVENC asc, 
           PCPREST.DUPLIC, 
            PCPREST.PREST;
            
            
select ((((C.TXJUROS / 100)/30) * P.VALOR * ATRASO) + (C.PERCMULTA / 100) * P.VALOR)  - P.VALORDESC
 from PCPREST P
 join PCCOB C on P.CODCOB = C.CODCOB
     WHERE
      P.DTEMISSAO BETWEEN TO_DATE('27/12/2022', 'DD/MM/YYYY') AND TO_DATE('21/02/2023', 'DD/MM/YYYY')
     AND P.CODFILIAL IN ('2', '3', '4', '50', '96', '97', '98', '99')
     AND P.NUMTRANSVENDA = 168021
     AND P.PREST = 2
     AND ((TRUNC(SYSDATE) - P.DTVENC) >= 1)
    ORDER BY P.DTVENC, P.CODCLI; 

select * from PCPREST 
where NUMTRANSVENDA='5590';


select PERCMULTA from PCCOB