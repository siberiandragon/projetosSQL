select * from PCPEDI   
where NUMPED='1139000227';


select * from PCEMBALAGEM
WHERE CODPROD='804';



select distinct
PCPEDC.CODFILIAL as FILIAL,
 PCPEDC.DATA,
  decode(PCPEDC.CODFUNCEMISSAOMAPA,7,'PADRÃO',11,'ALLAN DIEGO',28,'GUILHERME CAVALCANTI',30,'ADRIANO ASSIS',51,'LAIZ CLEMENTINO',52,'WILLIANS CLEITON',53,'ALEX SANDRO',54,'ANDRE ROBSON',77,'PATRICIA SOUZA',78,'DIEGO MOURA',79,'RAFAEL MARTINS',94,'LEONARDO DE SOUZA',101,'JOSÉ JUNIOR',109,'JOSÉ HEWERTON') as EMITENTE_MAPA,
   decode(PCPEDC.CODFUNCSEP,7,'PADRÃO',11,'ALLAN DIEGO',28,'GUILHERME CAVALCANTI',30,'ADRIANO ASSIS',51,'LAIZ CLEMENTINO',52,'WILLIANS CLEITON',53,'ALEX SANDRO',54,'ANDRE ROBSON',77,'PATRICIA SOUZA',78,'DIEGO MOURA',79,'RAFAEL MARTINS',94,'LEONARDO DE SOUZA',101,'JOSÉ JUNIOR',109,'JOSÉ HEWERTON') as SEPARADOR, 
    decode(PCPEDC.CODFUNCCONF,7,'PADRÃO',11,'ALLAN DIEGO',28,'GUILHERME CAVALCANTI',30,'ADRIANO ASSIS',51,'LAIZ CLEMENTINO',52,'WILLIANS CLEITON',53,'ALEX SANDRO',54,'ANDRE ROBSON',77,'PATRICIA SOUZA',78,'DIEGO MOURA',79,'RAFAEL MARTINS',94,'LEONARDO DE SOUZA',101,'JOSÉ JUNIOR',109,'JOSÉ HEWERTON') as CONFERENTE,
    decode(PCPEDC.ORIGEMPED,'R','RETIRA','T','ENTREGA')as TIPO_VENDA,
     PCPEDC.NUMPED as PEDIDO,
      PCPEDC.TOTPESO as PESO_TOTAL,
       PCPEDC.NUMITENS as QTD_SKU,
        (select SUM (PCPEDI.QT / PCEMBALAGEM.QTUNIT) 
         from PCPEDI
         join PCEMBALAGEM on PCPEDI.CODPROD = PCEMBALAGEM.CODPROD and PCEMBALAGEM.CODFILIAL = PCPEDC.CODFILIAL
         where PCPEDI.NUMPED = PCPEDC.NUMPED)  as QTD_ITENS,
         PCPEDC.DTLIBERA as DTLIBERAÇÃO,
          PCPEDC.DTEMISSAOMAPA as DTEMISSÂO_MAPA,
           PCPEDC.DTINICIALSEP,
            PCPEDC.DTFINALCHECKOUT as DTCONFERÊNCIA,
            EXTRACT(HOUR FROM (NUMTODSINTERVAL(DTFINALCHECKOUT - DTEMISSAOMAPA, 'DAY'))) || ':' ||
             EXTRACT(MINUTE FROM (NUMTODSINTERVAL(DTFINALCHECKOUT - DTEMISSAOMAPA, 'DAY'))) || ':' ||
              EXTRACT(SECOND FROM (NUMTODSINTERVAL(DTFINALCHECKOUT - DTEMISSAOMAPA, 'DAY'))) AS TEMPO_MEDIO 
from PCPEDC
join PCEMPR on PCPEDC.CODFUNCSEP = PCEMPR.MATRICULA
--join PCPEDI on PCPEDC.NUMPED = PCPEDI.NUMPED
--join PCEMBALAGEM on PCPEDI.CODPROD = PCEMBALAGEM.CODPROD and PCEMBALAGEM.CODFILIAL = PCPEDC.CODFILIAL 
--join PCPEDC on PCEMBALAGEM.CODFILIAL = PCPEDC.CODFILIAL
--join PCPEDI on PCPEDC.NUMPED = PCPEDI.NUMPED
--join PCEMBALAGEM on PCPEDI.CODPROD = PCEMBALAGEM.CODPROD and PCPEDI.CODFILIALRETIRA = PCEMBALAGEM.CODFILIAL
where PCPEDC.NUMPED='1139000227'
--and rownum <=1;

SELECT 
    PCPEDC.CODFILIAL AS FILIAL,
    PCPEDC.DATA,
    DECODE(PCPEDC.CODFUNCEMISSAOMAPA, 7, 'PADRÃO', 11, 'ALLAN DIEGO', 28, 'GUILHERME CAVALCANTI', 30, 'ADRIANO ASSIS', 51, 'LAIZ CLEMENTINO', 52, 'WILLIANS CLEITON', 53, 'ALEX SANDRO', 54, 'ANDRE ROBSON', 77, 'PATRICIA SOUZA', 78, 'DIEGO MOURA', 79, 'RAFAEL MARTINS', 94, 'LEONARDO DE SOUZA', 101, 'JOSÉ JUNIOR', 109, 'JOSÉ HEWERTON') AS EMITENTE_MAPA,
    DECODE(PCPEDC.CODFUNCSEP, 7, 'PADRÃO', 11, 'ALLAN DIEGO', 28, 'GUILHERME CAVALCANTI', 30, 'ADRIANO ASSIS', 51, 'LAIZ CLEMENTINO', 52, 'WILLIANS CLEITON', 53, 'ALEX SANDRO', 54, 'ANDRE ROBSON', 77, 'PATRICIA SOUZA', 78, 'DIEGO MOURA', 79, 'RAFAEL MARTINS', 94, 'LEONARDO DE SOUZA', 101, 'JOSÉ JUNIOR', 109, 'JOSÉ HEWERTON') AS SEPARADOR, 
    DECODE(PCPEDC.CODFUNCCONF, 7, 'PADRÃO', 11, 'ALLAN DIEGO', 28, 'GUILHERME CAVALCANTI', 30, 'ADRIANO ASSIS', 51, 'LAIZ CLEMENTINO', 52, 'WILLIANS CLEITON', 53, 'ALEX SANDRO', 54, 'ANDRE ROBSON', 77, 'PATRICIA SOUZA', 78, 'DIEGO MOURA', 79, 'RAFAEL MARTINS', 94, 'LEONARDO DE SOUZA', 101, 'JOSÉ JUNIOR', 109, 'JOSÉ HEWERTON') AS CONFERENTE,
    DECODE(PCPEDC.ORIGEMPED, 'R', 'RETIRA', 'T', 'ENTREGA') AS TIPO_VENDA,
    PCPEDC.NUMPED AS PEDIDO,
    PCPEDC.TOTPESO AS PESO_TOTAL,
    PCPEDC.NUMITENS AS QTD_SKU,
    (PCPEDC.TOTVOLUME / PCEMBALAGEM.QTUNIT) AS QTD_ITENS,
    PCPEDC.DTLIBERA AS DTLIBERAÇÃO,
    PCPEDC.DTEMISSAOMAPA AS DTEMISSÃO_MAPA,
    PCPEDC.DTINICIALSEP,
    PCPEDC.DTFINALCHECKOUT AS DTCONFERÊNCIA,
    EXTRACT(HOUR FROM (NUMTODSINTERVAL(DTFINALCHECKOUT - DTEMISSAOMAPA, 'DAY'))) || ':' ||
    EXTRACT(MINUTE FROM (NUMTODSINTERVAL(DTFINALCHECKOUT - DTEMISSAOMAPA, 'DAY'))) || ':' ||
    EXTRACT(SECOND FROM (NUMTODSINTERVAL(DTFINALCHECKOUT - DTEMISSAOMAPA, 'DAY'))) AS TEMPO_MEDIO 
FROM PCPEDC
JOIN PCEMPR ON PCPEDC.CODFUNCSEP = PCEMPR.MATRICULA
JOIN PCPEDI ON PCPEDC.NUMPED = PCPEDI.NUMPED
JOIN PCEMBALAGEM ON PCPEDI.CODPROD = PCEMBALAGEM.CODPROD
WHERE PCPEDC.NUMPED = '1011000680';




select HORAEMISSAOMAPA, MINUTOEMISSAOMAPA, DTFINALCHECKOUT from PCPEDC
where NUMPED='1122000306';

select DTEMISSAOMAPA, DTFINALCHECKOUT from PCPEDC
where NUMPED='1122000306';

SELECT TO_CHAR(DTEMISSAOMAPA, 'HH24:MI:SS') AS HORAEMISSAOMAPA,
       TO_CHAR(DTFINALCHECKOUT, 'HH24:MI:SS') AS DTFINALCHECKOUT
FROM PCPEDC
WHERE NUMPED='1122000306';



SELECT TO_NUMBER(TO_CHAR(DTEMISSAOMAPA, 'HH24')) AS HORAEMISSAO_HORAS,
       TO_NUMBER(TO_CHAR(DTEMISSAOMAPA, 'MI')) AS HORAEMISSAO_MINUTOS,
       TO_NUMBER(TO_CHAR(DTEMISSAOMAPA, 'SS')) AS HORAEMISSAO_SEGUNDOS,
       TO_NUMBER(TO_CHAR(DTFINALCHECKOUT, 'HH24')) AS HORACHECKOUT_HORAS,
       TO_NUMBER(TO_CHAR(DTFINALCHECKOUT, 'MI')) AS HORACHECKOUT_MINUTOS,
       TO_NUMBER(TO_CHAR(DTFINALCHECKOUT, 'SS')) AS HORACHECKOUT_SEGUNDOS,
       (TO_NUMBER(TO_CHAR(DTEMISSAOMAPA, 'HH24')) - TO_NUMBER(TO_CHAR(DTFINALCHECKOUT, 'HH24'))) as HORA_FINAL,
         (TO_NUMBER(TO_CHAR(DTEMISSAOMAPA, 'MI')) - TO_NUMBER(TO_CHAR(DTFINALCHECKOUT, 'MI'))) as MINU_FINAL,
           (TO_NUMBER(TO_CHAR(DTEMISSAOMAPA, 'SS')) - TO_NUMBER(TO_CHAR(DTFINALCHECKOUT, 'SS'))) as SEG_FINAL
FROM PCPEDC
WHERE NUMPED='1122000306';

SELECT TO_NUMBER(TO_CHAR(DTEMISSAOMAPA, 'HH24')) * 10000 +
       TO_NUMBER(TO_CHAR(DTEMISSAOMAPA, 'MI')) * 100 +
       TO_NUMBER(TO_CHAR(DTEMISSAOMAPA, 'SS')) AS DTEMISSAOMAPA_COMPLETO,
       TO_NUMBER(TO_CHAR(DTFINALCHECKOUT, 'HH24')) * 10000 +
       TO_NUMBER(TO_CHAR(DTFINALCHECKOUT, 'MI')) * 100 +
       TO_NUMBER(TO_CHAR(DTFINALCHECKOUT, 'SS')) AS DTFINALCHECKOUT_COMPLETO
FROM PCPEDC
WHERE NUMPED='1122000306';


SELECT (TO_NUMBER(TO_CHAR(DTFINALCHECKOUT, 'HH24')) * 10000 +
        TO_NUMBER(TO_CHAR(DTFINALCHECKOUT, 'MI')) * 100 +
        TO_NUMBER(TO_CHAR(DTFINALCHECKOUT, 'SS'))) -
       (TO_NUMBER(TO_CHAR(DTEMISSAOMAPA, 'HH24')) * 10000 +
        TO_NUMBER(TO_CHAR(DTEMISSAOMAPA, 'MI')) * 100 +
        TO_NUMBER(TO_CHAR(DTEMISSAOMAPA, 'SS'))) AS DIFFERENCE
FROM PCPEDC
WHERE NUMPED='1122000306';

SELECT EXTRACT(HOUR FROM (DTFINALCHECKOUT - DTEMISSAOMAPA)) || ':' ||
       EXTRACT(MINUTE FROM (DTFINALCHECKOUT - DTEMISSAOMAPA)) || ':' ||
       EXTRACT(SECOND FROM (DTFINALCHECKOUT - DTEMISSAOMAPA)) AS DIFFERENCE
FROM PCPEDC
WHERE NUMPED='1122000306';

SELECT 
    EXTRACT(HOUR FROM(NUMTODSINTERVAL (DTEMISSAOMAPA, 'DAY'))) AS HORAEMISSAO_HORAS, || ':' ||
    EXTRACT(MINUTE FROM(NUMTODSINTERVAL (DTEMISSAOMAPA,'DAY'))) AS HORAEMISSAO_MINUTOS,|| ':' ||
    EXTRACT(SECOND FROM(NUMTODSINTERVAL (DTEMISSAOMAPA, 'DAY'))) AS HORAEMISSAO_SEGUNDOS,
    EXTRACT(HOUR FROM(NUMTODSINTERVAL (DTFINALCHECKOUT, 'DAY'))) AS HORACHECKOUT_HORAS, || ':' ||
    EXTRACT(MINUTE FROM(NUMTODSINTERVAL (DTFINALCHECKOUT, 'DAY'))) AS HORACHECKOUT_MINUTOS, || ':' ||
    EXTRACT(SECOND FROM(NUMTODSINTERVAL (DTFINALCHECKOUT, 'DAY'))) AS HORACHECKOUT_SEGUNDOS
FROM PCPEDC
WHERE NUMPED = '1122000306';




SELECT EXTRACT(HOUR FROM (NUMTODSINTERVAL(DTFINALCHECKOUT - DTEMISSAOMAPA, 'DAY'))) || ':' ||
       EXTRACT(MINUTE FROM (NUMTODSINTERVAL(DTFINALCHECKOUT - DTEMISSAOMAPA, 'DAY'))) || ':' ||
       EXTRACT(SECOND FROM (NUMTODSINTERVAL(DTFINALCHECKOUT - DTEMISSAOMAPA, 'DAY'))) AS MÉDIA_TEMPO
FROM PCPEDC
WHERE NUMPED='1122000306';

--(1) NUMTODSINTERVAL(DTFINALCHECKOUT - DTEMISSAOMAPA, 'DAY'): Essa parte da consulta calcula a diferença entre DTFINALCHECKOUT e DTEMISSAOMAPA em dias e retorna um intervalo de tempo.
--(2) EXTRACT(HOUR FROM <interval>): Essa função EXTRACT é usada para extrair as horas do intervalo de tempo. No caso, estamos extraindo as horas do intervalo calculado anteriormente.
--(3) EXTRACT(MINUTE FROM <interval>): Aqui, utilizamos a função EXTRACT para extrair os minutos do intervalo de tempo.
--(4)EXTRACT(SECOND FROM <interval>): Nessa parte, a função EXTRACT é utilizada para extrair os segundos do intervalo de tempo.
--(5) SELECT <expressão1> || ':' || <expressão2> || ':' || <expressão3> AS DIFFERENCE: Utilizamos o operador || para concatenar as horas, minutos e segundos obtidos anteriormente, separados por ':'. O resultado final é renomeado como DIFFERENCE.
--(6) Dessa forma, a consulta retorna a diferença de tempo no formato 'HH24:MI:SS' entre os campos DTEMISSAOMAPA e DTFINALCHECKOUT para o registro específico em que NUMPED é igual a '1122000306'.


     
    