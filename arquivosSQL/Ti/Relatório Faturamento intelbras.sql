
select distinct
  PCFILIAL.CGC as Filial_CNPJ, 
   PCCLIENT.CLIENTE,
    PCMOV.NUMNOTA as  N_NOTA,
     case
      when PCMOV.DTCANCEL is not null
      then 'Cancelada'
      when PCMOV.CODFISCAL in ('1202', '1203', '1204', '1208', '1209', '1411', '2204', '2209', '5202', '5213', '5214', '5215', '5410', 
                               '5411', '5412', '5413', '5553', '5555', '5556', '5918', '5919', '6202', '6213', '6214', '6215', '6410',
                               '6411', '6412', '6413', '6553', '6555', '6556', '6918', '6919', '2202')
      then 'Devolução'
      when PCMOV.CODFISCAL in ('5101', '5102', '5103', '5104', '5105', '5106', '5109', '5110', '5111', '5112', '5113', '5114', '5115', 
                               '5116', '5117', '5118', '5119', '5120', '5122', '5123', '5131', '5132', '5401', '5402', '5403', '5405', 
                               '5551', '5910', '6101', '6102', '6103', '6104', '6105', '6106', '6109', '6110', '6111', '6112', '6113', 
                               '6114', '6115', '6116', '6117', '6118', '6119', '6120', '6122', '6123', '6131', '6132', '6401', '6402', 
                               '6403', '6404', '6405', '6551', '6910', '6108')
      then 'Venda'
      else 'Outra'
     end SITUACAO,
         PCPRODUT.DESCRICAO as PRODUTO, 
          PCPRODUT.CODFAB,
           PCSECAO.DESCRICAO as SEGMENTO,
            to_char(PCMOV.DTMOV, 'Month', 'NLS_DATE_LANGUAGE=Portuguese')||'/'||to_char(PCMOV.DTMOV, 'YYYY') as MES,
             PCMOV.DTMOV,
              PCMOV.PUNIT, 
               PCMOV.QT
from PCMOV
join PCCLIENT on PCMOV.CODCLI = PCCLIENT.CODCLI
join PCPRODUT on PCMOV.CODPROD = PCPRODUT.CODPROD 
join PCSECAO on PCMOV.CODSEC = PCSECAO.CODSEC
join PCFILIAL on PCMOV.CODFILIAL = PCFILIAL.CODIGO
where 
PCMOV.NUMNOTA='15949'and 
PCMOV.CODFISCAL 
in ('5101', '5102', '5103', '5104', '5105', '5106', '5109', '5110', '5111', '5112', '5113', '5114', '5115', '5116', '5117',
    '5118', '5119', '5120', '5122', '5123', '5131', '5132', '5401', '5402', '5403', '5405', '5551', '6101', '6102', '6103', 
    '6104', '6105', '6106', '6109', '6110', '6111', '6112', '6113', '6114', '6115', '6116', '6117', '6118', '6119', '6120', 
    '6122', '6123', '6131', '6132', '6401', '6402', '6403', '6404', '6405', '6551', '1202', '1203', '1204', '1208', '1209', 
    '1411', '2204', '2209', '5202', '5213', '5214', '5215', '5410', '5411', '5412', '5413', '5553', '5555', '5556', '5918', 
    '5919', '6202', '6213', '6214', '6215', '6410', '6411', '6412', '6413', '6553', '6555', '6556', '6918', '6919', '2202', '6108',
    '5910', '6910')
order by PCMOV.PUNIT




